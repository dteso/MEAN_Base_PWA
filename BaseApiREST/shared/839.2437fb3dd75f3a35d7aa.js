(self.webpackChunklogin_app=self.webpackChunklogin_app||[]).push([[839],{5839:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ResourcesModule:()=>C});var r=i(8583),o=i(6304),n=i(2340),s=i(7716),l=i(6578),c=i(5146);let a=(()=>{class e{constructor(e,t){this.storage=e,this.apiService=t}subirArchivo(e,t,i){var r=this;return(0,o.Z)(function*(){try{const t=`${n.N.api_url}/upload`,o=new FormData;o.append("image",e),o.append("folder",i);const s=yield fetch(t,{method:"PUT",headers:{"x-token":r.storage.getItem("USER").token},body:o}),l=yield s.json();return console.log(l),l.ok?l.file:(console.log(l.msg),!1)}catch(t){console.log(t)}})()}getAllfiles(){return this.apiService.get("upload/list")}deleteFile(e){return this.apiService.delete(`upload/file/${e}`)}createFolder(e){return this.apiService.post("upload/folder",{folderSrc:e})}deleteFolder(e){return this.apiService.put("upload/folder",{folderSrc:e})}getStructure(e){return this.apiService.post("upload/structure",{path:e})}getFilesByFolder(e){const t=e.split("/");return this.apiService.get(`upload/list/${t[t.length-1]}`)}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(l.V),s.LFG(c.s))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var d=i(5727),g=i(8259),h=i.n(g),u=i(5389),p=i(9744);let f=(()=>{class e{transform(e){let t=e.split("/");return t[t.length-1]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=s.Yjl({name:"getFolderName",type:e,pure:!0}),e})(),m=(()=>{class e{transform(e,t=10){const i=e.replace(/(<([^>]+)>)/gi,"");return i.length>=t?`${i.slice(0,t)}...`:i}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=s.Yjl({name:"ellipsis",type:e,pure:!0}),e})();function Z(e,t){1&e&&(s.TgZ(0,"div",11),s._UZ(1,"i",12),s.qZA())}function b(e,t){if(1&e&&(s.TgZ(0,"h1",11),s._uU(1),s.qZA()),2&e){const e=s.oxw();s.xp6(1),s.hij(" ",e.currentPath,"")}}function v(e,t){1&e&&(s.TgZ(0,"div",13),s.TgZ(1,"h1",14),s._UZ(2,"i",15),s._uU(3," Server directories"),s.qZA(),s.TgZ(4,"p",14),s._uU(5,"No changes will be allowed in this directory tree. This is a tree view structure project for develpment usage."),s.qZA(),s.qZA())}function F(e,t){if(1&e&&(s.TgZ(0,"div"),s.TgZ(1,"label",26),s.TgZ(2,"strong"),s._uU(3,"Preview"),s.qZA(),s.qZA(),s.TgZ(4,"div",27),s._UZ(5,"img",28),s.qZA(),s.qZA()),2&e){const e=s.oxw(2);s.xp6(5),s.Q6J("src",e.imgTemp,s.LSH)}}function w(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",16),s.TgZ(1,"div",17),s.TgZ(2,"button",18),s.NdJ("click",function(){return s.CHM(e),s.oxw().onShowFileInput()}),s._UZ(3,"i",19),s.qZA(),s.qZA(),s.YNc(4,F,6,1,"div",20),s.TgZ(5,"div",21),s.TgZ(6,"input",22),s.NdJ("change",function(t){return s.CHM(e),s.oxw().loadFile(t)}),s.qZA(),s.qZA(),s.TgZ(7,"button",23),s.NdJ("click",function(){return s.CHM(e),s.oxw().uploadFile()}),s._UZ(8,"i",24),s.TgZ(9,"strong",25),s._uU(10),s.ALo(11,"translate"),s.qZA(),s.qZA(),s.qZA()}if(2&e){const e=s.oxw();s.xp6(4),s.Q6J("ngIf",e.imgTemp&&!e.isPdf),s.xp6(3),s.Q6J("disabled",!e.fileToUpload&&!e.isPdf),s.xp6(3),s.Oqu(s.lcZ(11,3,"BUTTON.ACTION.UPLOAD"))}}function T(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",29),s.TgZ(1,"div",30),s.NdJ("click",function(){return s.CHM(e),s.oxw().onBackFolder()}),s._UZ(2,"i",31),s.qZA(),s.TgZ(3,"div",32),s.TgZ(4,"div",33),s.NdJ("click",function(){return s.CHM(e),s.oxw().onShowFileInput()}),s._UZ(5,"i",34),s.qZA(),s.TgZ(6,"div",35),s.NdJ("click",function(){s.CHM(e);const t=s.oxw();return t.createFolder(t.currentPath)}),s._UZ(7,"i",36),s.qZA(),s.qZA(),s.qZA()}}function x(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",41),s.NdJ("click",function(){s.CHM(e);const t=s.oxw().$implicit;return s.oxw().getTreeNode(t.path)}),s._UZ(1,"i",42),s._uU(2),s.ALo(3,"getFolderName"),s.qZA()}if(2&e){const e=s.oxw().$implicit;s.xp6(2),s.Oqu(s.lcZ(3,1,e.path))}}function A(e,t){if(1&e&&(s.TgZ(0,"div",43),s._UZ(1,"i",44),s._uU(2),s.qZA()),2&e){const e=s.oxw().$implicit;s.xp6(2),s.Oqu(e.path)}}function U(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",45),s.NdJ("click",function(){s.CHM(e);const t=s.oxw().$implicit;return s.oxw().deleteFolder(t.path)}),s._UZ(1,"i",46),s.qZA()}}function I(e,t){if(1&e&&(s.TgZ(0,"div",37),s.YNc(1,x,4,3,"div",38),s.YNc(2,A,3,1,"div",39),s.YNc(3,U,2,0,"div",40),s.qZA()),2&e){const e=t.$implicit,i=s.oxw();s.xp6(1),s.Q6J("ngIf",!i.verifyIfIsFile(e.path)),s.xp6(1),s.Q6J("ngIf",i.verifyIfIsFile(e.path)&&!i.isImage(e.path)),s.xp6(1),s.Q6J("ngIf",!i.verifyIfIsFile(e.path)&&i.currentPath&&i.currentPath.length&&"."!==i.currentPath)}}function S(e,t){1&e&&(s.TgZ(0,"div",47),s.TgZ(1,"div",48),s.TgZ(2,"strong"),s._uU(3,"File"),s.qZA(),s.qZA(),s.TgZ(4,"div",49),s.TgZ(5,"p"),s._uU(6,"Folder"),s.qZA(),s.qZA(),s.TgZ(7,"div",49),s._uU(8," Image "),s.qZA(),s.TgZ(9,"div",50),s._uU(10," Action "),s.qZA(),s.qZA())}function k(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"div",51),s.TgZ(1,"div",48),s.TgZ(2,"strong"),s._uU(3),s.ALo(4,"ellipsis"),s.qZA(),s.qZA(),s.TgZ(5,"div",49),s.TgZ(6,"p"),s._uU(7),s.qZA(),s.qZA(),s.TgZ(8,"div",52),s.NdJ("click",function(){const t=s.CHM(e).$implicit;return s.oxw().showImage(t.src)}),s.TgZ(9,"img",53),s.NdJ("load",function(){return s.CHM(e),s.oxw().setLoaded()}),s.qZA(),s.qZA(),s.TgZ(10,"div",50),s.TgZ(11,"i",54),s.NdJ("click",function(){const t=s.CHM(e).$implicit;return s.oxw().deleteFile(t.uid)}),s.qZA(),s.qZA(),s._UZ(12,"hr"),s.qZA()}if(2&e){const e=t.$implicit;s.xp6(3),s.Oqu(s.lcZ(4,3,e.name)),s.xp6(4),s.hij("/",e.folder,""),s.xp6(2),s.Q6J("src",e.src,s.LSH)}}const q=function(e){return{blured:e}},L="./shared",P=h().mixin({toast:!0,position:"top",background:"black",showConfirmButton:!1,timer:3e3,didOpen:e=>{e.addEventListener("mouseenter",h().stopTimer),e.addEventListener("mouseleave",h().resumeTimer)}}),_=[{path:"",component:(()=>{class e{constructor(e,t,i,r,o){this.fileUploadService=e,this.translateService=t,this.loaderService=i,this.storage=r,this.apiService=o,this.imagesLoadedCounter=0,this.imagesLoadedLength=0,this.isLoading=!0,this.showFileInput=!1,this.routes=[],this.previousFolder=L,this.currentPath=L,this.loaderService._loading$.next(!0)}ngOnInit(){this.fileUploadService.getFilesByFolder("shared").subscribe(e=>{console.log("Files",e),this.dbFiles=e.dbFiles,this.routes=e.routes.children,this.dbFiles.map(e=>e.src=this.getTruePath(e.src)),this.imagesLoadedLength=this.dbFiles.length,0===this.imagesLoadedLength&&this.loaderService._loading$.next(!1),this.isLoading=!1,console.log(this.dbFiles)})}loadFile(e){if(this.fileToUpload=e.target.files[0],console.log(this.fileToUpload),!this.fileToUpload)return;const t=new FileReader;t.readAsDataURL(this.fileToUpload),t.onloadend=()=>{console.log(t.result),this.imgTemp=t.result,"application/pdf"===this.fileToUpload.type&&(this.isPdf=!0)}}uploadFile(){console.log("Archivo subido!!!");const e=this.currentPath.split("/")[this.currentPath.split("/").length-1];this.fileUploadService.subirArchivo(this.fileToUpload,"tipo1",this.currentPath).then(t=>{console.log("Imagen subida: "+t),this.imgTemp=void 0,this.fileToUpload=void 0,this.showPrompt(this.translateService.instant("FILE.UPLOAD.SUCCESS")),this.fileUploadService.getFilesByFolder(e).subscribe(e=>{this.dbFiles=e.dbFiles,this.dbFiles.map(e=>e.src=this.getTruePath(e.src)),this.imagesLoadedLength=this.dbFiles.length,this.showFileInput=!1})})}deleteFile(e){this.fileUploadService.deleteFile(e).subscribe(e=>{this.showPrompt(this.translateService.instant("FILE.DELETE.SUCCESS")),this.routes=e.routes.children,this.fileUploadService.getFilesByFolder(this.currentPath).subscribe(e=>{this.dbFiles=e.dbFiles,this.dbFiles.map(e=>e.src=this.getTruePath(e.src)),this.imagesLoadedLength=this.dbFiles.length})})}createFolder(e){console.log(e),h().fire({title:"File Name",input:"text",showCancelButton:!0,confirmButtonText:"Create",cancelButtonText:"Close"}).then(t=>{t.value&&this.fileUploadService.createFolder(`${e}/${t.value}`).subscribe(e=>{this.showPrompt(this.translateService.instant("FILE.FOLDER_CREATE.SUCCESS")),this.routes=e.routes.children})})}deleteFolder(e){this.fileUploadService.deleteFolder(`${e}`).subscribe(t=>{this.showPrompt(this.translateService.instant("FILE.FOLDER_DELETE.SUCCESS")),this.routes=t.routes.children,this.currentPath=this.getDirFromFileRoute(e)})}onBackFolder(){let e,t=this.currentPath.split("/");t.pop(),e=t.join("/"),this.getTreeNode(e)}getTreeNode(e){console.log("Getting tree node by root: ",e),this.currentPath=e,this.fileUploadService.getStructure(e).subscribe(t=>{t.paths&&(this.routes=t.paths.children),"."!==e&&this.fileUploadService.getFilesByFolder(e).subscribe(e=>{this.dbFiles=e.dbFiles,this.dbFiles.map(e=>e.src=this.getTruePath(e.src)),this.imagesLoadedLength=this.dbFiles.length,0===this.imagesLoadedLength&&this.loaderService._loading$.next(!1),this.isLoading=!1,console.log(this.dbFiles)})})}showPrompt(e){P.fire({icon:"success",title:e})}getTruePath(e){return`${n.N.base_url}${(e=e.substring(L.length,e.length)).substring(1,e.length)}`}setLoaded(){this.imagesLoadedCounter++,this.imagesLoadedCounter===this.imagesLoadedLength&&(this.isLoading=!1,this.loaderService._loading$.next(!1))}verifyIfIsFile(e){return e.substring(1,e.length).indexOf(".")>0}onShowFileInput(){this.showFileInput=!this.showFileInput}getDirFromFileRoute(e){let t=e.split("/");return t.pop(),t.join("/")}isImage(e){let t=e.substring(L.length,e.length).split(".")[e.substring(L.length,e.length).split(".").length-1];return["jpg","jpeg","gif","png"].includes(t)}showImage(e){h().fire({imageUrl:e,imageWidth:400,imageAlt:"Custom image",showConfirmButton:!1})}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(a),s.Y36(u.sK),s.Y36(p.D),s.Y36(l.V),s.Y36(c.s))},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-resources"]],decls:15,vars:11,consts:[[1,"mb-3","mt-5","p-4",2,"text-align","center","background","rgb(29, 28, 28)","opacity","90%",3,"ngClass"],["style","color: white;",4,"ngIf"],[2,"padding","0.5rem","background","rgb(8, 10, 10)","border-radius","2%"],["style","color: white",4,"ngIf","ngIfElse"],["adviceBlock",""],["class","animated flipInX","style","padding: 1rem; border: solid 0.1rem rgb(42, 42, 42);border-radius: 2rem;",4,"ngIf"],["class","row flex-center mt-3","style","color: white; background-color: black; padding: 0.5rem;",4,"ngIf"],[2,"color","silver"],["class","row mt-1 animated flipInX",4,"ngFor","ngForOf"],["class","row mt-2","style","color: white; font-weight: bolder; background: black; opacity: 60%; padding-top: 0.5rem;",4,"ngIf"],["style","color: white;","class","row",4,"ngFor","ngForOf"],[2,"color","white"],[1,"fa","fa-file-pdf-o",2,"color","white","font-size","15rem"],[2,"background-color","rgb(250, 189, 189)","opacity","60%","padding","3rem","font-weight","bolder"],[2,"color","red"],[1,"fa","fa-exclamation-triangle"],[1,"animated","flipInX",2,"padding","1rem","border","solid 0.1rem rgb(42, 42, 42)","border-radius","2rem"],[1,"w-100",2,"text-align","right"],[1,"btn","btn-danger","mt-3",3,"click"],[1,"fa","fa-close"],[4,"ngIf"],[1,"mb-3","mt-3"],["type","file","accept","image/*","id","formFile",1,"form-control",3,"change"],[1,"btn","btn-info","mt-3",3,"disabled","click"],[1,"fa","fa-upload"],[2,"color","white","padding-left","1rem"],[1,"form-label",2,"color","white"],[1,"w-100",2,"height","auto"],[2,"border","1px solid white","max-width","100%","max-height","100%",3,"src"],[1,"row","flex-center","mt-3",2,"color","white","background-color","black","padding","0.5rem"],["title","Back",1,"col",2,"text-align","left","cursor","pointer",3,"click"],[1,"fa","fa-arrow-left",2,"font-size","1.5rem"],[1,"col","contents-right"],["title","Upload File",2,"cursor","pointer","margin-left","2rem",3,"click"],[1,"fa","fa-upload",2,"font-size","1.5rem"],["title","Create Folder",2,"cursor","pointer","margin-left","2rem",3,"click"],[1,"fa","fa-folder",2,"font-size","1.5rem"],[1,"row","mt-1","animated","flipInX"],["class","col folder",3,"click",4,"ngIf"],["style","color: white; text-align: left; font-size: larger; opacity: 70%; padding: 1rem; cursor: pointer; border-radius: 1%",4,"ngIf"],["class","col-1 mt-3","style","color: rgb(231, 132, 3); cursor: pointer; font-size: 1.5rem;",3,"click",4,"ngIf"],[1,"col","folder",3,"click"],[1,"fa","fa-folder","p-2"],[2,"color","white","text-align","left","font-size","larger","opacity","70%","padding","1rem","cursor","pointer","border-radius","1%"],[1,"fa","fa-file","p-2"],[1,"col-1","mt-3",2,"color","rgb(231, 132, 3)","cursor","pointer","font-size","1.5rem",3,"click"],[1,"fa","fa-trash"],[1,"row","mt-2",2,"color","white","font-weight","bolder","background","black","opacity","60%","padding-top","0.5rem"],[1,"col-4",2,"text-align","left"],[1,"col-3"],[1,"col-2"],[1,"row",2,"color","white"],[1,"col-3",2,"cursor","pointer",3,"click"],["width","35rem","height","35rem",3,"src","load"],[1,"fa","fa-trash",2,"cursor","pointer",3,"click"]],template:function(e,t){if(1&e&&(s.TgZ(0,"div",0),s.YNc(1,Z,2,0,"div",1),s.TgZ(2,"div",2),s.YNc(3,b,2,1,"h1",3),s.qZA(),s.YNc(4,v,6,0,"ng-template",null,4,s.W1O),s._UZ(6,"hr"),s.TgZ(7,"div"),s.YNc(8,w,12,5,"div",5),s.YNc(9,T,8,0,"div",6),s._UZ(10,"hr",7),s.YNc(11,I,4,3,"div",8),s.qZA(),s.YNc(12,S,11,0,"div",9),s._UZ(13,"hr"),s.YNc(14,k,13,5,"div",10),s.qZA()),2&e){const e=s.MAs(5);s.Q6J("ngClass",s.VKq(9,q,t.isLoading)),s.xp6(1),s.Q6J("ngIf",t.isPdf),s.xp6(2),s.Q6J("ngIf",t.currentPath&&t.currentPath.length&&"."!==t.currentPath)("ngIfElse",e),s.xp6(5),s.Q6J("ngIf",t.currentPath&&t.currentPath.length&&"."!==t.currentPath&&t.showFileInput),s.xp6(1),s.Q6J("ngIf",t.currentPath&&t.currentPath.length&&"."!==t.currentPath),s.xp6(2),s.Q6J("ngForOf",t.routes),s.xp6(1),s.Q6J("ngIf",t.dbFiles&&t.dbFiles.length),s.xp6(2),s.Q6J("ngForOf",t.dbFiles)}},directives:[r.mk,r.O5,r.sg],pipes:[u.X$,f,m],styles:[".folder[_ngcontent-%COMP%]{color:#fff;text-align:left;font-size:larger;background-color:#098ff0;opacity:70%;padding:1rem;cursor:pointer;border-radius:1%}.folder[_ngcontent-%COMP%]:hover{background-color:#034a7c}i[_ngcontent-%COMP%]:hover{font-size:1.6rem!important}.file[_ngcontent-%COMP%]{color:#fff;text-align:left;font-size:larger;background-color:#0b6eaf;opacity:70%;padding:1rem;cursor:pointer;border-radius:3%}.contents-right[_ngcontent-%COMP%]{text-align:right;display:contents}"]}),e})()}];let y=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.oAB({type:e}),e.\u0275inj=s.cJS({imports:[[d.Bz.forChild(_)],d.Bz]}),e})(),C=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.oAB({type:e}),e.\u0275inj=s.cJS({providers:[a,u.sK],imports:[[r.ez,y,u.aw]]}),e})()}}]);